<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Interactive Charts</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-adapter-date-fns@3"></script>
    <style>
        body { font-family: Arial, sans-serif; }
        .container { width: 50%; margin: auto; }
        h1, h2 { text-align: center; }
        h1 { font-size: 28px; margin-bottom: 10px; }
        h2 { font-size: 18px; color: black; margin-bottom: 30px; }
        .chart-container { margin-bottom: 50px; }
        .dropdown { margin: 10px 0; }        
        canvas {
            width: 100%;
            height: auto;
            max-height: 400px;
            margin-bottom: 30px;
        }
    </style>
</head>
<body>
    <div class="container">
       <h1>Economic Impact on U.S. Rentals and Home Sales:</h1>
       <h2>Pre, During, and Post Pandemic (2018-2022)</h2>

        <div class="chart-container">
            <div class="dropdown">
                <label for="dataset2">Select Economic Indicator:</label>
                <select id="dataset2" onchange="updateChart1()">
                    <option value="average_mortgage">Avg Mortgage Rate</option>
                    <option value="median_hhi">Median HHI</option>
                    <option value="unemployment_data">Unemployment Rate</option>
                </select>
            </div>
            <canvas id="chart1"></canvas>
        </div>
        
        <div class="chart-container">
            <div class="dropdown">
                <label for="dataset1">Select Housing Market Data:</label>
                <select id="dataset1" onchange="updateChart2()">
                    <option value="rental">US Rentals</option>
                    <option value="sales">US Home Sales</option>
                    <option value="home_value">US Home Values</option>
                </select>
            </div>
            <canvas id="chart2"></canvas>
        </div>
    </div>

    <script>
        let chart1, chart2;

        function fetchData(dataset, callback) {
            fetch(`/get_data/${dataset}`)
                .then(response => {
                    if (!response.ok) {
                        throw new Error(`Network response was not ok: ${response.statusText}`);
                    }
                    return response.json();
                })
                .then(data => callback(data))
                .catch(error => {
                    console.error('Error fetching data:', error);
                    alert('Failed to load data. Please try again.');
                });
        }

        function updateChart1() {
            const dataset2 = document.getElementById('dataset2').value;
            fetchData(dataset2, (data) => {
                const labels = Object.keys(data);
                const values = Object.values(data).map(d => Object.values(d)[0]);

                if (chart1) chart1.destroy();

                chart1 = new Chart(document.getElementById('chart1'), {
                    type: 'line',
                    data: {
                        labels: labels,
                        datasets: [{
                            label: dataset2.replace('_', ' ').toUpperCase(),
                            backgroundColor: 'rgba(75, 192, 192, 0.2)',
                            borderColor: 'rgba(75, 192, 192, 1)',
                            data: values,
                            fill: false
                        }]
                    },
                    options: {
                        responsive: true,
                        scales: {
                            x: { 
                                type: 'time', 
                                time: { unit: 'year' } 
                            },
                            y: { beginAtZero: true }
                        }
                    }
                });
            });
        }

        function updateChart2() {
            const dataset1 = document.getElementById('dataset1').value;

            const datasetMapping = {
                rental: 'us_rental_data_2018_2022',
                sales: 'us_home_sales_data_2018_2022',
                home_value: 'us_home_value_data_2018_2022'
            };

            fetchData(datasetMapping[dataset1], (data) => {
                console.log("Received data:", data);

                const labels = Object.keys(data);
                const values = Object.values(data).map(d => d.Rentals || d.Sales || d['Home Value']);


                if (chart2) chart2.destroy();

                chart2 = new Chart(document.getElementById('chart2'), {
                    type: 'line',
                    data: {
                        labels: labels,
                        datasets: [{
                            label: dataset1.replace('_', ' ').toUpperCase() + " Data",    
                            backgroundColor: 'rgba(255, 99, 132, 0.2)',
                            borderColor: 'rgba(255, 99, 132, 1)',
                            data: values,
                            fill: false
                        }]
                    },
                    options: {
                        responsive: true,
                        scales: {
                            x: { 
                                type: 'time', 
                                time: { unit: 'month' },
                                displayFormats:{
                                    month: 'MMM YYYY'
                                } 
                            },
                            y: { beginAtZero: true }
                        }
                    }
                });
            }).catch(error => console.error('Error fetching or processing data:', error));
        }

        // Set default values and load the charts on page load
        document.getElementById('dataset1').value = 'rental';
        document.getElementById('dataset2').value = 'average_mortgage';
        updateChart1();
        updateChart2();
    </script>
</body>
</html>



















































<!----> Most recent HTML >
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Interactive Charts</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-adapter-date-fns@3"></script>
    <style>
        body { font-family: Arial, sans-serif; }
        .container { width: 50%; margin: auto; }
        h1, h2 { text-align: center;}
        h1 {font-size: 28px; margin-bottom: 10px;}
        h2 {font-size: 18px; color: black; margin-bottom: 30px;}
        .chart-container { margin-bottom: 50px;}
        .dropdown { margin: 10px 0; }        
        canvas {
            width: 80%;
            height: 300px;
            margin-bottom: 30px;
        }
    </style>
</head>
<body>
    <div class="container">
       <!-- Main Header -->
       <h1>Economic Impact on U.S. Rentals and Home Sales:</h1>

       <!-- Subheader -->
       <h2>Pre, During, and Post Pandemic (2018-2022)</h2>

        <!-- Dropdown for Economic Indicators (Should Update Chart 1) -->
        <div class="chart-container">
            <div class="dropdown">
                <label for="dataset2">Select Economic Indicator:</label>
                <select id="dataset2" onchange="updateChart1()"> <!-- Updates Chart 1 -->
                    <option value="average_mortgage">Avg Mortgage Rate</option>
                    <option value="median_hhi">Median HHI</option>
                    <option value="unemployment_data">Unemployment Rate</option>
                </select>
            </div>
            <!-- Canvas for Chart 1 (Economic Indicators) -->
            <canvas id="chart1"></canvas>
        </div>
        
        <!-- Dropdown for Rental/Home Sales Data (Should Update Chart 2) -->
        <div class="chart-container">
            <div class="dropdown">
                <label for="dataset1">Select Housing Market Data:</label>
                <select id="dataset1" onchange="updateChart2()"> <!-- Updates Chart 2 -->
                    <option value="rental">US Rentals</option>
                    <option value="sales">US Home Sales</option>
                    <option value="home_value">US Home Values</option>
                </select>
            </div>
            <!-- Canvas for Chart 2 (Housing Market Data) -->
            <canvas id="chart2"></canvas>
        </div>
    </div>

    <script>
        let chart1, chart2;
    
        function fetchData(dataset, callback) {
            fetch(`/get_data/${dataset}`)
                .then(response => response.json())
                .then(data => callback(data))
                .catch(error => console.error('Error fetching data:', error));
        }
    
        // Function to update Chart 1 (Economic Indicators)
        function updateChart1() {
            const dataset2 = document.getElementById('dataset2').value;
            fetchData(dataset2, (data) => {
                const labels = Object.keys(data);
                const values = Object.values(data).map(d => Object.values(d)[0]);

                if (chart1) chart1.destroy();

                chart1 = new Chart(document.getElementById('chart1'), {
                    type: 'line',
                    data: {
                        labels: labels,
                        datasets: [{
                            label: dataset2.replace('_', ' ').toUpperCase(),
                            backgroundColor: 'rgba(75, 192, 192, 0.2)',
                            borderColor: 'rgba(75, 192, 192, 1)',
                            data: values,
                            fill: false
                        }]
                    },
                    options: {
                        responsive: true,
                        scales: {
                            x: { 
                                type: 'time',  // Requires date adapter
                                time: { unit: 'year' } 
                            },
                            y: { beginAtZero: true }
                        }
                    }
                });
            });
        }
    
        // Function to update Chart 2 (Housing Market Data)
        function updateChart2() {
            const dataset1 = document.getElementById('dataset1').value;

            const datasetMapping = {
                rental: 'us_rental_prices_data_2018_2022',
            sales: 'us_home_sales_data_2018_2022',
            home_value: 'us_home_value_data_2018_2022'  // Ensure consistency with Flask
    };
    
    fetchData(datasetMapping[dataset1], (data) => {
        const labels = Object.keys(data);
        const values = Object.values(data).map(d => {
            if (dataset1 === 'rental') return d.Rentals;
            if (dataset1 === 'sales') return d.Sales;
            if (dataset1 === 'home_value') return d['Home Value'];
});
    

        if (chart2) chart2.destroy();

        chart2 = new Chart(document.getElementById('chart2'), {
            type: 'line',
            data: {
                labels: labels,
                datasets: [{
                    label: dataset1 === 'rental' ? 'Rentals' : dataset1 === 'sales' ? 'Sales' : 'Home Values',
                    backgroundColor: 'rgba(255, 99, 132, 0.2)',
                    borderColor: 'rgba(255, 99, 132, 1)',
                    data: values,
                    fill: false
                }]
            },
            options: {
                responsive: true,
                scales: {
                    x: { 
                        type: 'time',  // Requires date adapter
                        time: { unit: 'year' } 
                    },
                    y: { beginAtZero: true }
                }
            }
        });
    });
}

        // Load the initial charts on page load
        updateChart1();  // Load Chart 1 (Economic Indicators)
        updateChart2();  // Load Chart 2 (Rental/Home Sales/Home values)
    </script>
</body>
</html>


  // END//





  //Start Tatyana///
  <!DOCTYPE html>
  <html lang="en">
  <head>
      <meta charset="UTF-8">
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <title>Housing and Rental Prices</title>
      <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  </head>
  <body>
      <h1>Housing and Rental Prices Comparison</h1>
  
      <!-- Dropdown to select city -->
      <label for="citySelect">Select City:</label>
      <select id="citySelect">
          <!-- Options will be dynamically populated -->
      </select>
  
      <div id="housingPercentChange"></div>
      <div id="rentalPercentChange"></div>        
  
      <!-- Canvas for Housing Prices Graph -->
      <canvas id="housingChart" width="400" height="200"></canvas>
      <br>
  
      <!-- Canvas for Rental Prices Graph -->
      <canvas id="rentalChart" width="400" height="200"></canvas>
  
      <script>
          // URLs for the JSON datasets
          const housingUrl = 'https://raw.githubusercontent.com/elgnol/RealEstate_Project_3/tatyana/Analysis/filtered_home_df.json';
          const rentalUrl = 'https://raw.githubusercontent.com/elgnol/RealEstate_Project_3/tatyana/Analysis/rental_df.json';
  
          let housingData = [];
          let rentalData = [];
          let cities = [];
          let housingPercentChangeElement;
          let rentalPercentChangeElement;
  
          // Load both datasets and initialize the page
          async function loadData() {
              const housingResponse = await fetch(housingUrl);
              const rentalResponse = await fetch(rentalUrl);
  
              housingData = await housingResponse.json();
              rentalData = await rentalResponse.json();
  
              // Assuming both datasets are aligned and have the same structure
              cities = housingData.map(row => row.RegionName);
  
              // Populate the dropdown with city names
              const citySelect = document.getElementById('citySelect');
              cities.forEach((city, index) => {
                  const option = document.createElement('option');
                  option.value = index;
                  option.text = city;
                  citySelect.appendChild(option);
              });
  
              // Create elements to display percent change
              housingPercentChangeElement = document.getElementById('housingPercentChange');
              rentalPercentChangeElement = document.getElementById('rentalPercentChange');
              
              // Default city (first city in the list)
              updateGraphs(0);
  
              // Add event listener for when the user selects a different city
              citySelect.addEventListener('change', function() {
                  updateGraphs(this.value);
              });
          }
  
          // Function to update graphs based on selected city
          function updateGraphs(cityIndex) {
              const selectedHousingRow = housingData[cityIndex];
              const selectedRentalRow = rentalData[cityIndex];
  
              const housingLabels = Object.keys(selectedHousingRow).filter(key => key.match(/^\d{4}-\d{2}-\d{2}$/));
              const housingPrices = housingLabels.map(date => parseFloat(selectedHousingRow[date]));
  
              const rentalLabels = Object.keys(selectedRentalRow).filter(key => key.match(/^\d{4}-\d{2}-\d{2}$/));
              const rentalPrices = rentalLabels.map(date => parseFloat(selectedRentalRow[date]));
  
              // Access the percent change from the last column of each dataset
              const housingPercentChange = selectedHousingRow[Object.keys(selectedHousingRow).pop()]; // Last column
              const rentalPercentChange = selectedRentalRow[Object.keys(selectedRentalRow).pop()]; // Last column
  
              // Update the percent change display
              housingPercentChangeElement.innerText = `Housing Price Change: ${housingPercentChange}%`;
              rentalPercentChangeElement.innerText = `Rental Price Change: ${rentalPercentChange}%`;
              
              // Update the housing chart
              createLineChart('housingChart', housingLabels, housingPrices, 'Housing Prices', 'rgba(75, 192, 192, 1)');
  
              // Update the rental chart
              createLineChart('rentalChart', rentalLabels, rentalPrices, 'Rental Prices', 'rgba(255, 99, 132, 1)');
          }
  
      // Function to create/update a line chart
      function createLineChart(canvasId, labels, data, label, color) {
          const ctx = document.getElementById(canvasId).getContext('2d');
      
          // If a chart already exists, destroy it before creating a new one
          if (window[canvasId] instanceof Chart) {
              window[canvasId].destroy();
          }
  
          // Create a new chart
          window[canvasId] = new Chart(ctx, {
              type: 'line',
              data: {
                  labels: labels,
                  datasets: [{
                      label: label,
                      data: data,
                      fill: false,
                      borderColor: color, // Use the color parameter here
                      tension: 0.1
                  }]
              },
              options: {
                  responsive: true,
                  scales: {
                      x: {
                          title: {
                              display: true,
                              text: 'Date'
                          }
                      },
                      y: {
                          title: {
                          display: true,
                          text: 'Price ($)'
                          },
                          beginAtZero: false
                      }
                  }
              }
          });
      }
      // Load data when the page loads
      loadData();
      </script>
  </body>
  </html>

  //End//























<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Interactive Charts</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-adapter-date-fns@3"></script>
    <style>
        body { font-family: Arial, sans-serif; }
        .container { width: 80%; margin: auto; }
        .dropdown { margin: 20px; }        
        canvas {
            width: 100%;
            height: 400px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Interactive Data Charts (2018-2022)</h1>
        <!-- Dropdown for Other Data -->
        <div class="dropdown">
            <label for="dataset2">Choose Other Data:</label>
            <select id="dataset2" onchange="updateChart2()">
                <option value="average_mortgage">Average Mortgage 2018-2022</option>
                <option value="median_hhi">Median HHI 2018-2022</option>
                <option value="unemployment_data">Unemployment Data 2018-2022</option>
            </select>
        </div>

        <!-- Dropdown for Rental/Sales Data -->
        <div class="dropdown">
            <label for="dataset1">Choose Rental Data or Sales Data:</label>
            <select id="dataset1" onchange="updateChart1()">
                <option value="rental">US Rental Data 2018-2022</option>
                <option value="sales">US Sales Data 2018-2022</option>
            </select>
        </div>

        <!-- Canvas for Charts -->
        <canvas id="chart2"></canvas>
        <canvas id="chart1"></canvas>
    </div>

    <script>
        let chart1, chart2;
    
        function fetchData(dataset, callback) {
            fetch(`/get_data/${dataset}`)
                .then(response => response.json())
                .then(data => callback(data))
                .catch(error => console.error('Error fetching data:', error));  // Add this to catch fetch errors
        }
    
        function updateChart1() {
            const dataset1 = document.getElementById('dataset1').value;
            fetchData(dataset1, (data) => {
                const labels = Object.keys(data);
                const values = Object.values(data).map(d => d.Sales || d.Rentals);
    
                if (chart1) chart1.destroy();
    
                chart1 = new Chart(document.getElementById('chart1'), {
                    type: 'line',
                    data: {
                        labels: labels,
                        datasets: [{
                            label: dataset1 === 'rental' ? 'Rentals' : 'Sales',
                            backgroundColor: 'rgba(54, 162, 235, 0.2)',
                            borderColor: 'rgba(54, 162, 235, 1)',
                            data: values,
                            fill: false
                        }]
                    },
                    options: {
                        responsive: true,
                        scales: {
                            x: { 
                                type: 'time',  // Requires a date adapter
                                time: { unit: 'year' } 
                            },
                            y: { beginAtZero: true }
                        }
                    }
                });
            });
        }
    
        function updateChart2() {
            const dataset2 = document.getElementById('dataset2').value;
            fetchData(dataset2, (data) => {
                const labels = Object.keys(data);
                const values = Object.values(data).map(d => Object.values(d)[0]);
    
                if (chart2) chart2.destroy();
    
                chart2 = new Chart(document.getElementById('chart2'), {
                    type: 'line',
                    data: {
                        labels: labels,
                        datasets: [{
                            label: dataset2.replace('_', ' ').toUpperCase(),
                            backgroundColor: 'rgba(255, 99, 132, 0.2)',
                            borderColor: 'rgba(255, 99, 132, 1)',
                            data: values,
                            fill: false
                        }]
                    },
                    options: {
                        responsive: true,
                        scales: {
                            x: { 
                                type: 'time',  // Requires a date adapter
                                time: { unit: 'year' } 
                            },
                            y: { beginAtZero: true }
                        }
                    }
                });
            });
        }
    
        // Load initial charts
        updateChart1();
        updateChart2();
    </script>
</body>
</html>










<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Interactive Charts</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-adapter-date-fns@3"></script>  <!-- Include date adapter -->
    <style>
        body { 
            font-family: Arial, sans-serif; 
        }
        .container { 
            width: 80%; 
            margin: auto; 
        }
        .dropdown { 
            margin: 20px; 
        }
        canvas {
            width: 100%;  /* Set to 100% of the parent container */
            height: 400px;  /* Ensure height is a reasonable size, like 400px */
            margin-bottom: 50px;  /* Add space between the charts */
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Interactive Data Charts (2018-2022)</h1>

        <!-- Dropdown for HHI, Unemployment, Mortgage Data (Chart 1) -->
        <div class="dropdown">
            <label for="dataset1">Choose Data for Chart 1:</label>
            <select id="dataset1" onchange="updateChart1()">
                <option value="median_hhi">Median HHI 2018-2022</option>
                <option value="unemployment_data">Unemployment Data 2018-2022</option>
                <option value="average_mortgage">Average Mortgage 2018-2022</option>
            </select>
        </div>

        <!-- Canvas for Chart 1 -->
        <canvas id="chart1"></canvas>

        <!-- Dropdown for Sales/Rentals Data (Chart 2) -->
        <div class="dropdown">
            <label for="dataset2">Choose Data for Chart 2:</label>
            <select id="dataset2" onchange="updateChart2()">
                <option value="sales">US Sales Data 2018-2022</option>
                <option value="rental">US Rental Data 2018-2022</option>
            </select>
        </div>

        <!-- Canvas for Chart 2 -->
        <canvas id="chart2"></canvas>
    </div>

    <script>
        let chart1, chart2;

        // Fetch data from the Flask API based on selected dataset
        function fetchData(dataset, callback) {
            fetch(`/get_data/${dataset}`)
                .then(response => response.json())
                .then(data => {
                    console.log('Fetched data:', data);  // Debug: Log the fetched data
                    callback(data);
                })
                .catch(error => console.error('Error fetching data:', error));  // Catch fetch errors
        }

// Update Chart 1 for HHI, Unemployment, Mortgage Data
function updateChart1() {
    const dataset1 = document.getElementById('dataset1').value;
    fetchData(dataset1, (data) => {
        // Extract and format labels (dates) and values
        const labels = Object.keys(data).map(date => new Date(date));
        const values = Object.values(data).map(d => Object.values(d)[0]);

        console.log('Labels (dates):', labels);  // Debug log to see if date data is correct
        console.log('Values:', values);

        // Destroy the existing chart if it exists
        if (chart1) chart1.destroy();

        chart1 = new Chart(document.getElementById('chart1'), {
            type: 'line',
            data: {
                labels: labels,  // Format labels as Date objects
                datasets: [{
                    label: dataset1.replace('_', ' ').toUpperCase(),
                    backgroundColor: 'rgba(75, 192, 192, 0.2)',
                    borderColor: 'rgba(75, 192, 192, 1)',
                    data: values,
                    fill: false,
                    tension: 0.1  // Add some smoothness to the line
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,  // Adjusts canvas size
                scales: {
                    x: { 
                        type: 'time',  // Use time scale for date-based x-axis
                        time: {
                            unit: 'year',  // Display ticks for each year
                            tooltipFormat: 'YYYY'  // Tooltip format for year
                        },
                        title: {
                            display: true,
                            text: 'Year'
                        }
                    },
                    y: { 
                        beginAtZero: true,
                        title: {
                            display: true,
                            text: 'Value'
                        }
                    }
                }
            }
        });
    });
}

// Update Chart 2 for Sales and Rentals Data
function updateChart2() {
    const dataset2 = document.getElementById('dataset2').value;
    fetchData(dataset2, (data) => {
        // Extract and format labels (dates) and values
        const labels = Object.keys(data).map(date => new Date(date));
        const values = Object.values(data).map(d => d.Sales || d.Rentals);

        console.log('Labels (dates):', labels);  // Debug log for date-based labels
        console.log('Values:', values);  // Log sales/rentals values

        if (chart2) chart2.destroy();  // Destroy old chart instance

        chart2 = new Chart(document.getElementById('chart2'), {
            type: 'line',
            data: {
                labels: labels,  // Use formatted Date objects for labels
                datasets: [{
                    label: dataset2 === 'rental' ? 'Rentals' : 'Sales',
                    backgroundColor: 'rgba(255, 99, 132, 0.2)',
                    borderColor: 'rgba(255, 99, 132, 1)',
                    data: values,
                    fill: false,
                    tension: 0.1  // Add smoothness to the line
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                scales: {
                    x: { 
                        type: 'time',  // Use time scale for x-axis
                        time: {
                            unit: 'year',
                            tooltipFormat: 'YYYY'
                        },
                        title: {
                            display: true,
                            text: 'Year'
                        }
                    },
                    y: { 
                        beginAtZero: true,
                        title: {
                            display: true,
                            text: 'Value'
                        }
                    }
                }
            }
        });
    });
}
// Load the initial charts on page load
updateChart1();  // Load Chart 1 with the default dataset (Median HHI)
updateChart2();  // Load Chart 2 with the default dataset (Sales)
    </script>
</body>
</html>
